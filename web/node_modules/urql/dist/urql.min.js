var e=require("@urql/core"),t=require("react"),r=require("wonka"),n=e.createClient({url:"/graphql"}),u=t.createContext(n),o=u.Provider,a=u.Consumer,c=function(){return t.useContext(u)};function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var s={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0,operation:void 0};function f(n){var u=t.useRef(!0),o=c(),a=t.useState(s),f=a[0],l=a[1];function p(e){return u.current&&l({fetching:!1,stale:!!e.stale,data:e.data,error:e.error,extensions:e.extensions,operation:e.operation}),e}var v=t.useCallback((function(t,u){return l(i({},s,{fetching:!0})),r.toPromise(o.executeMutation(e.createRequest(n,t),u||{})).then(p)}),[o,n,l]);function x(){u.current=!1}return t.useEffect((function(){return x}),[]),[f,v]}var l=!1;function p(e,n){function u(){return e}var o=t.useMemo((function(){var t=r.makeSubject();return[r.concat([r.map(u)(r.fromValue(e)),t.source]),function(r){var n=e;try{r!==n&&t.next(e=r)}catch(t){throw e=n,t}}]}),[]),a=o[0],c=o[1],i=t.useState((function(){var e;return l=!0,r.subscribe((function(t){e=t}))(n(a)).unsubscribe(),l=!1,e})),s=i[0],f=i[1];function p(e){l||f((function(t){return function(e,t){if("object"!=typeof e||"object"!=typeof t)return e!==t;for(var r in e)if(!(r in t))return!0;for(var n in t)if(e[n]!==t[n])return!0;return!1}(t,e)?e:t}))}return t.useEffect((function(){return r.subscribe(p)(n(a,s)).unsubscribe}),[a]),[s,c]}function v(r,n){var u=t.useRef(void 0);return t.useMemo((function(){var t=e.createRequest(r,n);return void 0!==u.current&&u.current.key===t.key?u.current:(u.current=t,t)}),[r,n])}var x=function(e,t){return e.suspense&&(!t||!1!==t.suspense)},d=new Map;function h(e,t){return i({},e,t)}function b(e){return{fetching:!1,stale:!!e.stale,data:e.data,error:e.error,operation:e.operation,extensions:e.extensions}}function y(e){return e?r.concat([r.fromValue({fetching:!0,stale:!1}),r.map(b)(e),r.fromValue({fetching:!1,stale:!1})]):r.fromValue({fetching:!1,stale:!1})}function m(e,t){return r.scan(h,t||s)(r.switchMap(y)(e))}function g(e){var n=c(),u=v(e.query,e.variables),o=t.useCallback((function(t){var o=x(n,e.context),a=o?d.get(u.key):void 0;return a||(a=n.executeQuery(u,i({},{requestPolicy:e.requestPolicy,pollInterval:e.pollInterval},e.context,t)),o&&(a=function(e){var t,n,u=r.share(e);function o(e){n=e}return function(e){var a=!1;if(r.takeWhile((function(e){return void 0===t&&Promise.resolve(e).then(n),t=e,!a}))(u)(e),void 0===t)throw a=!0,e(0),new Promise(o);var c=[t];c.tag=1,e(c)}}(a),"undefined"!=typeof window&&d.set(u.key,a))),a}),[n,u,e.requestPolicy,e.pollInterval,e.context]),a=t.useMemo((function(){return e.pause?null:o()}),[e.pause,o]),s=p(a,t.useCallback(m,[])),f=s[0],l=s[1],h=t.useCallback((function(e){return l(o(e))}),[l,o]);return t.useEffect((function(){d.delete(u.key),x(n,e.context)||l(a)}),[l,n,a,u,e.context]),x(n,e.context)&&l(a),[f,h]}function k(e){return{fetching:!0,stale:!!e.stale,data:e.data,error:e.error,extensions:e.extensions,operation:e.operation}}function C(e){return e?r.concat([r.fromValue({fetching:!0,stale:!1}),r.map(k)(e),r.fromValue({fetching:!1,stale:!1})]):r.fromValue({fetching:!1})}function q(e,n){var u=c(),o=t.useRef(n);o.current=n;var a=v(e.query,e.variables),f=t.useCallback((function(t){return u.executeSubscription(a,i({},e.context,t))}),[u,a,e.context]),l=t.useMemo((function(){return e.pause?null:f()}),[e.pause,f]);function x(e,t){var r=o.current;return i({},e,t,{data:void 0!==t.data?"function"==typeof r?r(e.data,t.data):t.data:e.data})}var d=p(l,t.useCallback((function(e,t){return r.scan(x,t||s)(r.switchMap(C)(e))}),[])),h=d[0],b=d[1],y=t.useCallback((function(e){return b(f(e))}),[b,f]);return t.useEffect((function(){b(l)}),[b,l]),[h,y]}Object.keys(e).forEach((function(t){"default"!==t&&(exports[t]=e[t])})),exports.Consumer=a,exports.Context=u,exports.Mutation=function(e){var t=f(e.query);return e.children(i({},t[0],{executeMutation:t[1]}))},exports.Provider=o,exports.Query=function(e){var t=g(e);return e.children(i({},t[0],{executeQuery:t[1]}))},exports.Subscription=function(e){var t=q(e,e.handler);return e.children(i({},t[0],{executeSubscription:t[1]}))},exports.useClient=c,exports.useMutation=f,exports.useQuery=g,exports.useSubscription=q;
//# sourceMappingURL=urql.min.js.map
