import{createClient as n,createRequest as t}from"@urql/core";export*from"@urql/core";import{createContext as r,useContext as e,useRef as o,useState as u,useCallback as i,useEffect as c,useMemo as a}from"react";import{toPromise as f,makeSubject as s,concat as v,map as l,fromValue as p,subscribe as d,takeWhile as h,share as x,scan as y,switchMap as g}from"wonka";var b=r(n({url:"/graphql"})),m=b.Provider,q=b.Consumer,w=function(){return e(b)};function P(){return(P=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n}).apply(this,arguments)}var k={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0,operation:void 0};function j(n){var r=o(!0),e=w(),a=u(k),s=a[0],v=a[1];function l(n){return r.current&&v({fetching:!1,stale:!!n.stale,data:n.data,error:n.error,extensions:n.extensions,operation:n.operation}),n}var p=i((function(r,o){return v(P({},k,{fetching:!0})),f(e.executeMutation(t(n,r),o||{})).then(l)}),[e,n,v]);function d(){r.current=!1}return c((function(){return d}),[]),[s,p]}var I=!1;function M(n,t){function r(){return n}var e=a((function(){var t=s();return[v([l(r)(p(n)),t.source]),function(r){var e=n;try{r!==e&&t.next(n=r)}catch(t){throw n=e,t}}]}),[]),o=e[0],i=e[1],f=u((function(){var n;return I=!0,d((function(t){n=t}))(t(o)).unsubscribe(),I=!1,n})),h=f[0],x=f[1];function y(n){I||x((function(t){return function(n,t){if("object"!=typeof n||"object"!=typeof t)return n!==t;for(var r in n)if(!(r in t))return!0;for(var e in t)if(n[e]!==t[e])return!0;return!1}(t,n)?n:t}))}return c((function(){return d(y)(t(o,h)).unsubscribe}),[o]),[h,i]}function O(n,r){var e=o(void 0);return a((function(){var o=t(n,r);return void 0!==e.current&&e.current.key===o.key?e.current:(e.current=o,o)}),[n,r])}var Q=function(n,t){return n.suspense&&(!t||!1!==t.suspense)},S=new Map;function C(n,t){return P({},n,t)}function z(n){return{fetching:!1,stale:!!n.stale,data:n.data,error:n.error,operation:n.operation,extensions:n.extensions}}function A(n){return n?v([p({fetching:!0,stale:!1}),l(z)(n),p({fetching:!1,stale:!1})]):p({fetching:!1,stale:!1})}function B(n,t){return y(C,t||k)(g(A)(n))}function D(n){var t=w(),r=O(n.query,n.variables),e=i((function(e){var o=Q(t,n.context),u=o?S.get(r.key):void 0;return u||(u=t.executeQuery(r,P({},{requestPolicy:n.requestPolicy,pollInterval:n.pollInterval},n.context,e)),o&&(u=function(n){var t,r,e=x(n);function o(n){r=n}return function(n){var u=!1;if(h((function(n){return void 0===t&&Promise.resolve(n).then(r),t=n,!u}))(e)(n),void 0===t)throw u=!0,n(0),new Promise(o);var i=[t];i.tag=1,n(i)}}(u),"undefined"!=typeof window&&S.set(r.key,u))),u}),[t,r,n.requestPolicy,n.pollInterval,n.context]),o=a((function(){return n.pause?null:e()}),[n.pause,e]),u=M(o,i(B,[])),f=u[0],s=u[1],v=i((function(n){return s(e(n))}),[s,e]);return c((function(){S.delete(r.key),Q(t,n.context)||s(o)}),[s,t,o,r,n.context]),Q(t,n.context)&&s(o),[f,v]}function E(n){return{fetching:!0,stale:!!n.stale,data:n.data,error:n.error,extensions:n.extensions,operation:n.operation}}function F(n){return n?v([p({fetching:!0,stale:!1}),l(E)(n),p({fetching:!1,stale:!1})]):p({fetching:!1})}function G(n,t){var r=w(),e=o(t);e.current=t;var u=O(n.query,n.variables),f=i((function(t){return r.executeSubscription(u,P({},n.context,t))}),[r,u,n.context]),s=a((function(){return n.pause?null:f()}),[n.pause,f]);function v(n,t){var r=e.current;return P({},n,t,{data:void 0!==t.data?"function"==typeof r?r(n.data,t.data):t.data:n.data})}var l=M(s,i((function(n,t){return y(v,t||k)(g(F)(n))}),[])),p=l[0],d=l[1],h=i((function(n){return d(f(n))}),[d,f]);return c((function(){d(s)}),[d,s]),[p,h]}function H(n){var t=j(n.query);return n.children(P({},t[0],{executeMutation:t[1]}))}function J(n){var t=D(n);return n.children(P({},t[0],{executeQuery:t[1]}))}function K(n){var t=G(n,n.handler);return n.children(P({},t[0],{executeSubscription:t[1]}))}export{q as Consumer,b as Context,H as Mutation,m as Provider,J as Query,K as Subscription,w as useClient,j as useMutation,D as useQuery,G as useSubscription};
//# sourceMappingURL=urql.min.es.js.map
